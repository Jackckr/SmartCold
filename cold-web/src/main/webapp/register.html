<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>冷库360-注册-冷库能效在线管理系统</title>
	<meta charset="utf-8" name="keywords" content="冷库360,冷库监控,冷库智能管理,冷库能效评估，冷库认证与能耗管理"/>
	<meta charset="utf-8" name="description" content="冷库360-冷库能效在线管理系统"/>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link rel="shortcut icon" href="assets/img/favicon.ico" />
    <!-- Bootstrap 3.3.5 -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="assets/css/ionicons.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="assets/css/AdminLTE.min.css">
    <!-- iCheck -->
    <link rel="stylesheet" href="assets/plugins/iCheck/square/blue.css">

    <style type="text/css">
    	.typeCold {margin: 10px 0 20px;}
    	.typeCold .pull-left{
    		width: 25%;
    		line-height: 2;
    	}
    	.typeCold .checkbox-inline{
    		padding-left: 0;
    	}
    </style>
  </head>
  <body class="hold-transition register-page">
    <div class="register-box" style="width:400px;">
      <div class="register-logo">
        <label href=""><b>冷库360</b>SmartCold</label>
      </div>

      <div class="register-box-body">
        <p class="login-box-msg">新用户注册</p>
        <form action="../../index.html" method="post">
          <div class="form-group has-feedback">
            <input id="txt_username" type="text" class="form-control" placeholder="用户名" onblur="checkUserName()">
            <span class="glyphicon glyphicon-user form-control-feedback"></span>
          </div>
          <div class="form-group has-feedback">
            <input id="txt_password" type="password" class="form-control" placeholder="密码">
            <span class="glyphicon glyphicon-lock form-control-feedback"></span>
          </div>
          <div class="form-group has-feedback">
            <input  id="txt_refpassword" type="password" class="form-control" placeholder="重输密码">
            <span class="glyphicon glyphicon-log-in form-control-feedback"></span>
          </div>
          <div class="form-group has-feedback">
            <input id="txt_telephone" type="text" class="form-control" placeholder="手机号" onblur="checktelephone()">
            <span class="glyphicon glyphicon-envelope form-control-feedback" onclick="getviercode()"></span>
          </div>
          <div class="input-group">
            <input type="text" class="form-control" placeholder="输入验证码">
            <span id="sp_yzmbut" class="input-group-addon btn btn-primary" >获取验证码</span>
          </div>
          <div class="clearfix typeCold">
	      	<div style="width: 100%;">
	      		<label>注册类型</label>
	      	</div>
	      	<div class="pull-left">
	  	      <label class="checkbox-inline">
	  		    <input type="radio" name="coldType" value="10">基本版
	  		  </label>
	      	</div>
			<div class="pull-left">
		      <label class="checkbox-inline">
			    <input type="radio" name="coldType" value="11">智能版
			  </label>
		  	</div>
			<div class="pull-left">
		      <label class="checkbox-inline">
			    <input type="radio" name="coldType" value="12" checked="checked">聪慧版
			  </label>
		    </div>
		    <div class="pull-left">
		      <label class="checkbox-inline">
			    <input type="radio" name="coldType" value="9">维修版
			  </label>
		 	 </div>
	    </div>
          <div>
              <button id="submit" type="button" class="btn btn-primary btn-block btn-flat">注册</button>
          </div>
        </form>

        <div class="social-auth-links text-center">
        </div>

        <a href="login.html" class="text-center"></a>
      </div><!-- /.form-box -->
    </div><!-- /.register-box -->

    <!-- jQuery 2.1.4 -->
    <script src="assets/plugins/jQuery/jQuery-2.1.4.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script type="text/javascript">
	var victdata={key:new Date().getDate()*2-1,isdebugger:true, userName:false,victpwd:false,victel:false,victyzm:false};
	function vsphone(telephone) {// 验证手机号码
		var length = (telephone + '').length;
		var mobile = /^1[3|4|5|7|8][0-9]\d{4,8}$/;
		return telephone && length == 11&& mobile.test(telephone);
	};
	
	
    function checkUserName(){
   	    var username=$("#txt_username").val().trim();
   	    var reg=/^[a-zA-Z0-9][a-zA-Z0-9]{5,15}$/;
   	    if(username&&username.length>6&&username.length<24&&reg.test(username)){
   	        $.post('/i/user/existenceUserName',{userName:username}, function(data){
				if(!data){ alert( "用户名已存在");}
				victdata.userName=true;
			});
   	    }else{
   	       victdata.userName=false;
//    	       $("#txt_username").focus();
   	       alert("用户名不能包含中文和特殊字符，长度在6到16位之间~");
   	    }
    };
    function getviercode(){
    	if(victdata.victel){
    		var url=isdebugger?"/http://localhost:8080/":"http://liankur.com/";
    		 $.post(url+'/i/user/getVerCode',{key:victdata.key,vercode:window.location.pathname,telephone:$("#txt_password").val().trim()}, function(data){
 				if(!data){ alert( "用户名已存在");}
 				victdata.userName=true;
 			});
    		
    	}
    };
    
    function checktelephone(){
		var telephone = $("#txt_password").val().trim();
		var ct = vsphone(telephone);
	    if(ct){
			victdata.victel=true;
		}else{
			 victdata.victel=false;
			 $("#phone").html("请输入正确手机号码");
			 $('#authcode').attr('disabled',!ct);
            $('#').attr("disabled",!ct);
		}
	};	
    
    //返回true 表示有问题  
    function checkPassword(){
    	var password = $('input[name=password]').val().trim();
    	var password1 = $('input[name=password1]').val().trim();
    	if(password == ''){
    		$("#password_error").html("密码不能为空~");
    		$('#').attr("disabled",true);
    		return false;
    	}else if(password.length<6){
    		$("#password_error").html("密码长度最少六位~");
    		$('#').attr("disabled",true);
    		return false;
    	}else if(password.length<=16){
    		$("#password_error").html("");
    		if (/^(\d)\1+$/.test(password)){
    			$("#password_error").html("密码太过简单了~").css("color","#f80");
    			$('#').attr("disabled",true);
    			return false;
    		}else{
    			if(password1.length<6){
    				$("#password_error1").html("再次输入的密码长度最少六位~");
    				$('#').attr("disabled",true);
    				return false;
    			}else if(password1.length>=6){
    				if(password != password1){
    					$("#password_error1").html("两次密码不一致~");
    					$('#').attr("disabled",true);
    					return false;
    				}else{
    					$("#password_error1").html("");
    					$('#').attr("disabled",false);
    				};
    			};
    		};
    	}else{
    		$("#password_error").html("密码长度最多16位~").css("color","#f80");
    		$('#').attr("disabled",true);
    	}
    }
    	
    	
    	function reguser(){
    		userName = $("#username").val().trim();
    		var password = $('input[name=password]').val().trim();
    		var password1 = $('input[name=password1]').val().trim();
    		var checkUserName = $("#username_error").html();
    		if(checkUserName != ""){
    			alert(checkUserName);
    		}else if(password != password1){
    			alert("两次密码不统一~");
    		}else{
    	    	$.ajax({
    	    		type:"POST",
    	    		data:{  username:userName,
    	    				password:password,
    	    				password1:password1,
    	    				type:$("input[name='usertype']:checked").val(),
    	    				telephone:$("#text_telephone").val().trim(),
    	    				signUpCode:$('input[name=signUpCode]').val().trim()},
    	    		url:"/i/user/signup?",
    	    		async:false}
    	    		).success(function(data){
        				   alert(data.message);
        				   if(data.status == "0"){
        						window.location.href = "http://" + window.location.host + "/login.html";
        						window.event.returnValue=false;
        				   }
        				}).error(function(data){
        					alert("系统错误");
    	    		});
    		}
    	}
    	
    	//return true;

    </script>
  </body>
</html>
