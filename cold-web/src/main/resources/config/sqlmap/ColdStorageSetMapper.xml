<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.smartcold.manage.cold.dao.olddb.ColdStorageSetMapper">
    

    
    <select id="findLastNPoint" parameterType="map" resultType="ColdStorageSetEntity">
        SELECT *
        FROM `ColdStorageSet` WHERE `id` = #{id} limit #{npoint}
    </select>

    <select id="findByRdcId" parameterType="map" resultType="ColdStorageSetEntity">
        SELECT *
        FROM `ColdStorageSet` WHERE `rdcId` = #{rdcId}
    </select>
    
    <select id="findById" parameterType="map" resultType="ColdStorageSetEntity">
        SELECT *
        FROM `ColdStorageSet` WHERE `id` = #{Id}
    </select>
    
    <select id="findAllColdStorage" parameterType="map" resultType="ColdStorageSetEntity">
        SELECT *
        FROM `ColdStorageSet`
    </select>
    
    <select id="findByFilter" parameterType="map" resultType="ColdStorageSetEntity">
		SELECT * FROM `ColdStorageSet` where 1=1  
		<if test="iunbalance!=null"> and iunbalance>${iunbalance}</if> 
	</select>
    
    <select id="findHasDoorStorage" resultType="ColdStorageSetEntity">
        select distinct c.*  
        FROM rdc r LEFT JOIN `coldstorageset` c on r.`id` =c.`RDCID` 
        LEFT JOIN `coldstoragedoorset`  d on c.`id` =d.`coldstorageid` 
        where r.`id`  = #{rdcId} AND d.id IS NOT null
    </select>

</mapper>