<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.smartcold.bgzigbee.manage.dao.RdcShareInfoMapper" >
    <resultMap id="shareInfo" type="RdcSharedInfoEntity">
        <association property="rdcEntity" column="rdcID" select="com.smartcold.bgzigbee.manage.dao.RdcMapper.getRdcById"></association>
    </resultMap>
    <delete id="delShareInfoById">
        DELETE FROM `shared_info` WHERE `id`=#{id}
    </delete>
    <select id="findShareInfo" resultMap="shareInfo">
        SELECT * FROM `shared_info` AS s LEFT JOIN `rdc` AS r  ON s.`rdcID`=r.`id`
        <where>
            <if test="startTime!=null and startTime!=''">
                s.`updateTime` >= #{startTime}
            </if>
            <if test="endTime!=null and endTime!=''">
                and s.`updateTime` &lt;= #{endTime}
            </if>
            <if test="type!=null and type!=''">
                and s.`typeText`=#{type}
            </if>
            <if test="stauts!=null and stauts!=''">
                and s.`stauts`=#{stauts}
            </if>
            <if test="keyword !=null and keyword !=''">
                and (s.`title` like #{keyword} or s.`detlAddress` like #{keyword} or s.`note` like #{keyword} or r.`name` like #{keyword})
            </if>
        </where>
        ORDER BY s.`id` DESC
    </select>
    <select id="findShareInfoById" resultMap="shareInfo">
        SELECT * FROM `shared_info` WHERE `id` =#{id}
    </select>
    
    <insert id="addshareInfo" parameterType="com.smartcold.bgzigbee.manage.entity.RdcShareDTO">
	     <selectKey resultType="java.lang.Integer" order="AFTER" keyProperty="id">
           SELECT LAST_INSERT_ID() AS id
          </selectKey>
		  INSERT INTO shared_info   
		  <set > 
								<if test=" rdcID         !=0">                          rdcID           =#{rdcID            }  ,</if>
								<if test=" releaseID     !=0">	                        releaseID       =#{releaseID        }  ,</if>
			                    <if test=" rentdate      !=null and rentdate  !=''">	rentdate       =#{rentdate        }  ,</if>
			                    <if test=" username      !=null and username  !=''">	username       =#{username        }  ,</if>
			                    <if test=" publishunit   !=null and publishunit  !=''">	publishunit       =#{publishunit        }  ,</if>
								<if test=" codeLave1     !=null and codeLave1  !=''">	codeLave1       =#{codeLave1        }  ,</if>
								<if test=" codeLave2     !=null and codeLave1  !=''">	codeLave2       =#{codeLave2        }  ,</if>
								<if test=" codeLave3     !=null and codeLave2  !=''">	codeLave3       =#{codeLave3        }  ,</if>
								<if test=" codeLave4     !=null and codeLave3  !=''">	codeLave4       =#{codeLave4        }  ,</if>
								<if test=" title         !=null and codeLave4  !=''">	title           =#{title            }  ,</if>
								<if test=" typeCode      !=0">                          typeCode        =#{typeCode         }  ,</if>
								<if test=" typeText      !=null and typeText   !=''">	typeText        =#{typeText         }  ,</if>
								<if test=" unitPrice     !=0 ">	                        unitPrice       =#{unitPrice        }  ,</if>
								<if test=" sqm           !=0 ">                         sqm             =#{sqm              }  ,</if>
								<if test=" unit          !=null and unit       !=''">	unit            =#{unit             }  ,</if>
								<if test=" unit1         !=null and unit1      !=''">	unit1           =#{unit1            }  ,</if>
								<if test=" unit2         !=null and unit2      !=''">	unit2           =#{unit2            }  ,</if>
								<if test=" validStartTime!=null and validStartTime!=''">validStartTime  =#{validStartTime   }  ,</if>
								<if test=" validEndTime  !=null and validEndTime  !=''">validEndTime    =#{validEndTime     }  ,</if>
								<if test=" applyID       !=0">	                        applyID         =#{applyID          }  ,</if>
								<if test=" bookings      !=0">	                        bookings        =#{bookings         }  ,</if>
								<if test=" attrvalue     !=null and attrvalue  !=''">	attrvalue       =#{attrvalue        }  ,</if>
								<if test=" attrvalue1     !=null and attrvalue1  !=''">	attrvalue1      =#{attrvalue1        }  ,</if>
								<if test=" attrvalue2     !=null and attrvalue2  !=''">	attrvalue2      =#{attrvalue2        }  ,</if>
								<if test=" telephone     !=null and telephone  !=''">	telephone       =#{telephone        }  ,</if>
								<if test=" note          !=null and note       !=''">	note            =#{note             }  ,</if>
								<if test=" stauts        !=0">	                        stauts          =#{stauts           }  ,</if>
								<if test=" stprovinceID  !=0">	                        stprovinceID    =#{stprovinceID     }  ,</if>
								<if test=" stcityID      !=0">	                        stcityID        =#{stcityID         }  ,</if>
								<if test=" staddress     !=null and telephone  !=''">	staddress       =#{staddress        }  ,</if>
								<if test=" toprovinceID  !=0">	                        toprovinceID    =#{toprovinceID     }  ,</if>
								<if test=" tocityID      !=0">	                        tocityID        =#{tocityID         }  ,</if>
								<if test=" toaddress     !=null and telephone  !=''">	 toaddress       =#{toaddress       }  ,</if>
								<if test=" provinceid    !=0">	                        provinceid      =#{provinceid       }  ,</if>
								<if test=" cityid        !=0">	                        cityid          =#{cityid           }  ,</if>
								<if test=" address       !=null and address    !=''">	address         =#{address          }  ,</if>
								<if test=" detlAddress   !=null and detlAddress!=''">	detlAddress     =#{detlAddress      }  ,</if>
								<if test=" dataType      !=0">	                        dataType        =#{dataType         }   </if>
		</set>    
	</insert>
	<update id="updateshareInfo" parameterType="com.smartcold.bgzigbee.manage.entity.RdcShareDTO" >
        update shared_info
        <set >
                                <if test=" rdcID         !=0">                          rdcID           =#{rdcID            }  ,</if> 
								<if test=" releaseID     !=0">	                        releaseID       =#{releaseID        }  ,</if>
								<if test=" codeLave1     !=null and codeLave1  !=''">	codeLave1       =#{codeLave1        }  ,</if>
								<if test=" codeLave2     !=null and codeLave1  !=''">	codeLave2       =#{codeLave2        }  ,</if>
								<if test=" codeLave3     !=null and codeLave2  !=''">	codeLave3       =#{codeLave3        }  ,</if>
								<if test=" codeLave4     !=null and codeLave3  !=''">	codeLave4       =#{codeLave4        }  ,</if>
		                        <if test=" rentdate      !=null and rentdate  !=''">	rentdate       =#{rentdate        }  ,</if>
		                        <if test=" username      !=null and username  !=''">	username       =#{username        }  ,</if>
		                        <if test=" publishunit   !=null and publishunit  !=''">	publishunit     =#{publishunit}  ,</if>
								<if test=" title         !=null and codeLave4  !=''">	title           =#{title            }  ,</if>
								<if test=" typeCode      !=0">                          typeCode        =#{typeCode         }  ,</if>
								<if test=" typeText      !=null and typeText   !=''">	typeText        =#{typeText         }  ,</if>
								                        unitPrice       =#{unitPrice        }  ,
								<if test=" sqm           !=0 ">                         sqm             =#{sqm              }  ,</if>
								<if test=" unit          !=null and unit       !=''">	unit            =#{unit             }  ,</if>
								<if test=" unit1         !=null and unit1      !=''">	unit1           =#{unit1            }  ,</if>
								<if test=" unit2         !=null and unit2      !=''">	unit2           =#{unit2            }  ,</if>
								<if test=" validStartTime!=null and validStartTime!=''">validStartTime  =#{validStartTime   }  ,</if>
								<if test=" validEndTime  !=null and validEndTime  !=''">validEndTime    =#{validEndTime     }  ,</if>
								<if test=" applyID       !=0">	                        applyID         =#{applyID          }  ,</if>
								<if test=" bookings      !=0">	                        bookings        =#{bookings         }  ,</if>
								<if test=" attrvalue     !=null and attrvalue  !=''">	attrvalue       =#{attrvalue        }  ,</if>
								<if test=" attrvalue1     !=null and attrvalue1  !=''">	attrvalue1      =#{attrvalue1        }  ,</if>
								<if test=" attrvalue2     !=null and attrvalue2  !=''">	attrvalue2      =#{attrvalue2        }  ,</if>
								<if test=" telephone     !=null and telephone  !=''">	telephone       =#{telephone        }  ,</if>
								<if test=" note          !=null and note       !=''">	note            =#{note             }  ,</if>
								<if test=" stauts        !=0">	                        stauts          =#{stauts           }  ,</if>
								<if test=" stprovinceID  !=0">	                        stprovinceID    =#{stprovinceID     }  ,</if>
								<if test=" stcityID      !=0">	                        stcityID        =#{stcityID         }  ,</if>
								<if test=" staddress     !=null and telephone  !=''">	staddress       =#{staddress        }  ,</if>
								<if test=" toprovinceID  !=0">	                        toprovinceID    =#{toprovinceID     }  ,</if>
								<if test=" tocityID      !=0">	                        tocityID        =#{tocityID         }  ,</if>
								<if test=" toaddress     !=null and telephone  !=''">	 toaddress       =#{toaddress       }  ,</if>
								<if test=" provinceid    !=0">	                        provinceid      =#{provinceid       }  ,</if>
								<if test=" cityid        !=0">	                        cityid          =#{cityid           }  ,</if>
								<if test=" address       !=null and address    !=''">	address         =#{address          }  ,</if>
								<if test=" detlAddress   !=null and detlAddress!=''">	detlAddress     =#{detlAddress      }  ,</if>
								<if test=" dataType      !=0">	                        dataType        =#{dataType         }   </if>
        </set>
        where id = #{id};
    </update>

</mapper>