<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.smartcold.zigbee.manage.dao.RdcExtMapper">

    <select id="findRdcExtList" parameterType="map" resultType="RdcExtEntity">
         SELECT * FROM `RdcExt`
    </select>

    <select id="findRDCExtByRDCId" parameterType="map" resultType="RdcExtEntity">
        SELECT * FROM `RdcExt` WHERE `rdcId` = #{rdcID}
    </select>

    <insert id="insertRdcExt" parameterType="RdcExtEntity"
            useGeneratedKeys="true" keyProperty="id">
        INSERT INTO `RdcExt` (
        `RDCID`,
        `companydevice`,
        `companystaff`,
        `managetype`,
        `storagetype`,
        `storagestruct`,
        `storageplatform`,
        `storageplatformtype`,
        `storageislihuo`,
        `storagelihuocontrol`,
        `storagelihuoarea`,
        `storagerefreg`,
        `storagetempmonitor`,
        `storagecapacity`,
        `storagecapacityheight`,
        `storagetruck`,
        `storagetempertype`,
        `facility`,
        `honorpiclocation`,
        `arrangepiclocation`,
        `storagepiclocation`,
        `hastruck`
        )
        VALUES
        (
        #{RDCID},
        #{companydevice},
        #{companystaff},
        #{managetype},
        #{storagetype},
        #{storagestruct},
        #{storageplatform},
        #{storageplatformtype},
        #{storageislihuo},
        #{storagelihuocontrol},
        #{storagelihuoarea},
        #{storagerefreg},
        #{storagetempmonitor},
        #{storagecapacity},
        #{storagecapacityheight},
        #{storagetruck},
        #{storagetempertype},
        #{facility},
        #{honorpiclocation},
        #{arrangepiclocation},
        #{storagepiclocation},
        #{hastruck}
        );
    </insert>

    <update id="updateRdcExt" parameterType="com.smartcold.zigbee.manage.entity.RdcExtEntity" >
        update RdcExt
        <set >
            <if test="companydevice != null" >
                companydevice = #{companydevice,jdbcType=TINYINT},
            </if>
            <if test="managetype != null" >
                managetype = #{managetype,jdbcType=TINYINT},
            </if>
             <if test="storagestruct != null" >
                storagestruct = #{storagestruct,jdbcType=TINYINT},
            </if>
            <if test="storagetype != null" >
                storagetype = #{storagetype,jdbcType=TINYINT},
            </if>
            <if test="storageplatform != null" >
                storageplatform = #{storageplatform,jdbcType=TINYINT},
            </if>
            <if test="storageislihuo != null" >
                storageislihuo = #{storageislihuo,jdbcType=TINYINT},
            </if>
            <if test="storagelihuocontrol != null" >
                storagelihuocontrol = #{storagelihuocontrol,jdbcType=TINYINT},
            </if>
            <if test="storagelihuoarea != null" >
                storagelihuoarea = #{storagelihuoarea,jdbcType=INTEGER},
            </if>
            <if test="storagerefreg != null" >
                storagerefreg = #{storagerefreg,jdbcType=TINYINT},
            </if>
            <if test="storagetempmonitor != null" >
                storagetempmonitor = #{storagetempmonitor,jdbcType=TINYINT},
            </if>
            <if test="storagecapacity != null" >
                storagecapacity = #{storagecapacity,jdbcType=VARCHAR},
            </if>
            <if test="storagecapacityheight != null" >
                storagecapacityheight = #{storagecapacityheight,jdbcType=VARCHAR},
            </if>
            <if test="storagetruck != null" >
                storagetruck = #{storagetruck,jdbcType=VARCHAR},
            </if>
            <if test="storagetempertype != null" >
                storagetempertype = #{storagetempertype,jdbcType=TINYINT},
            </if>
            <if test="facility != null" >
                facility = #{facility,jdbcType=VARCHAR},
            </if>
            <if test="honorpiclocation != null" >
                honorpiclocation = #{honorpiclocation,jdbcType=LONGVARCHAR},
            </if>
            <if test="arrangepiclocation != null" >
                arrangepiclocation = #{arrangepiclocation,jdbcType=LONGVARCHAR},
            </if>
            <if test="storagepiclocation != null" >
                storagepiclocation = #{storagepiclocation,jdbcType=LONGVARCHAR},
            </if>
            <if test="rdcscore != null" >
                rdcscore = #{rdcscore,jdbcType=FLOAT},
            </if>
            <if test="rdccommentcnt != null" >
                 rdccommentcnt = #{rdccommentcnt,jdbcType=INTEGER},
            </if>
            <if test="rdcrecommendpercent != null" >
                  rdcrecommendpercent = #{rdcrecommendpercent,jdbcType=INTEGER},
            </if>
        </set>
        where id = #{id,jdbcType=INTEGER}
    </update>
    
    <update id="increasePageView" parameterType="int">
    	UPDATE rdcext set pageview = pageview+1 where rdcid=#{rdcID};
    </update>

    <select id="findScoreRdcDTOList" parameterType="map" resultType="com.smartcold.zigbee.manage.dto.RdcScoreDTO">
        select rdc.id as id,rdc.name as name,ext.rdcscore as rdcscore,ext.rdccommentcnt as rdccommentcnt,ext.rdcrecommendpercent as rdcrecommendpercent from (select id,name from `Rdc`) as rdc left join (select RDCID,rdcscore,rdccommentcnt,rdcrecommendpercent from `RdcExt`) ext on rdc.id = ext.RDCID order by ext.rdcscore desc limit #{npoint};
    </select>

    <select id="findHotRdcDTOList" parameterType="map" resultType="com.smartcold.zigbee.manage.dto.RdcScoreDTO">
        select rdc.id as id,rdc.name as name,ext.rdcscore as rdcscore,ext.rdccommentcnt as rdccommentcnt,ext.rdcrecommendpercent as rdcrecommendpercent from (select id,name from `Rdc`) as rdc left join (select RDCID,pageview,rdcscore,rdccommentcnt,rdcrecommendpercent from `RdcExt`) ext on rdc.id = ext.RDCID order by ext.pageview desc limit #{npoint};
    </select>

   <delete id="deleteByRdcID">
		delete from RdcExt where rdcid=#{rdcID}
	</delete>
</mapper>