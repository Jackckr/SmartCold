<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>链库-登录</title>
    <meta charset="utf-8" name="keywords" content="找冷库，上链库，冷库出租、冷库求租、货品出售、货品求购；冷链物流；冷库360,冷库监控,冷库智能管理,冷库能效评估；"/>
    <meta charset="utf-8" name="description" content="找冷库，上链库，链库是一个冷库智能管理与云服务平台。它拥有海量冷库数据资源与需求信息，针对冷库仓位，你可以在我们的平台出租、求租、出售和求购，
        让您在第一时间找到你需要的内容，为您提供最及时全面的信息。国内最大、最权威的冷库信息平台，以及冷库管理可视化与能效在线评估系统。"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1"/>
    <link rel="shortcut icon" href="../img/favicon.ico" />
    <!--引入样式包-->
    <link rel="stylesheet" href="../plugins/css/layui.css" />
    <link rel="stylesheet" href="../css/common.css" />
    <link rel="stylesheet" href="../css/media.css" />
    <link rel="stylesheet" href="../css/login.css" />
</head>
<body>
<!--header 导航栏-->
<div class="header">
    <div class="hotLine">
        <h2 class="fl">全国最大的冷库数据与交易平台</h2>
        <div class="fr">
            <span>客服热线：<span class="orange">400-853-5606</span></span>
            <a href="#QRcode">
                APP下载<i class="iconfont orange">&#xe642;</i>
            </a>
        </div>
    </div>
    <div class="nav">
        <h1 class="fl"><a href="../../index.html" target="_blank">找冷库&nbsp;&nbsp;上链库</a></h1>
        <ul id="noLoginUser" class="fr navLogin">
            <li><a href="login.html"><i class="iconfont">&#xe715;</i>&nbsp;登录</a></li>
            <li><a href="register.html"><i class="iconfont">&#xe60f;</i>&nbsp;注册</a></li>
        </ul>
        <div id="loginUser" class="fr">
            <div class="nameDiv">
                <img src="">
            </div>
            <dl class="hide">
                <li><a href="usercenter.html">个人中心</a></li>
                <li><a onclick="logout()">退出</a></li>
            </dl>
        </div>
        <ul class="fr navUl">
            <li><a href="../../index.html">首　　页</a></li>
            <li><a href="rdclist.html">冷库商情</a></li>
            <li><a href="rdcprice.html">冷库价格</a></li>
            <li><a href="rdcmatch.html">需求匹配</a></li>
            <li><a href="rdctrace.html">温度追溯</a></li>
            <li><a href="http://www.smartcold.org.cn/">冷库360</a></li>
            <li><a href="standrdclist.html">企业专区</a></li>
        </ul>
    </div>
</div>
<div class="section loginStyle">
    <div class="loginDiv clearfix">
        <div class="loginBg"></div>

        <div class="login">
            <h2>用户名密码登录</h2>
            <form class="layui-form layui-form-pane" action="" onsubmit="return false">
                <div class="layui-form-item">
                    <label class="layui-form-label"><i class="iconfont">&#xe63d;</i></label>
                    <div class="layui-input-block">
                        <input type="text" name="userName" lay-verify="userName" autocomplete="off" placeholder="请输入用户名" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item" style="margin-bottom: 0;">
                    <label class="layui-form-label"><i class="iconfont">&#xe69c;</i></label>
                    <div class="layui-input-block">
                        <input type="password" name="password"lay-verify="pass" placeholder="请输入密码" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item" style="margin-top: 0;">
                    <div class="layui-form-mid layui-word-aux fl">
                        <a href="forgetpassword.html">忘记密码</a>
                    </div>
                    <div class="layui-form-mid layui-word-aux fr">
                        <a href="register.html">注册</a>
                    </div>
                </div>
                <div class="layui-form-item btnSubmit">
                    <button class="layui-btn" lay-submit="lianku" lay-filter="lianku">登录</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!--版权区域-->
<div class="footer" id="QRcode">
    <dl class="clearfix">
        <li class="fl">
            <p><a href="aboutlianku.html">关于我们</a></p>
            <p>©2016 Smartcold    沪ICP备 16004753</p>
            <p>为了您可以获取更佳的浏览效果</p>
            <p>本站推荐使用
                <a href="http://sw.bos.baidu.com/sw-search-sp/software/ba34c905dbdd4/ChromeStandalone_57.0.2987.98_Setup.exe">谷歌浏览器
                </a>、<a href="http://sw.bos.baidu.com/sw-search-sp/software/4cee66da4242e/Firefox_52.0.1.6284_setup.exe">火狐浏览器
                </a>或者<a href="http://down.360safe.com/se/360se8.1.1.250.exe">360浏览器极速模式</a>
            </p>
        </li>
        <li class="fr">
            <div class="codeImg">
                <img src="../img/ios.png" alt="开小差了~~~">
                <p>iPhone下载</p>
            </div>
            <div class="codeImg">

                <img src="../img/android.png" alt="开小差了~~~">
                <p>Android下载</p>
            </div>
            <div class="codeImg">
                <img src="../img/weixin_lianku.jpg" alt="开小差了~~~">
                <p>链库公众号</p>
            </div>
        </li>
    </dl>
</div>
<script src="../plugins/jquery-1.12.0.min.js"></script>
<script src="../plugins/layui.all.js"></script>
<script src="../js/common.js"></script>
<script>
    layui.use(['form'], function(){
        var form = layui.form(),layer = layui.layer;
        //自定义验证规则
        form.verify({
            userName: function(value, item){ //value：表单的值、item：表单的DOM对象
                if(!new RegExp("^[a-zA-Z0-9_\u4e00-\u9fa5\\s·]+$").test(value)){
                    return '用户名不能为空并且不能有特殊字符';
                }
                if(!/^[a-zA-Z0-9][a-zA-Z0-9]{2,23}$/.test(value)){
                    return '用户名不能包含中文和特殊字符，长度不得低于3位~'
                }
                if(/(^\_)|(\__)|(\_+$)/.test(value)){
                    return '用户名首尾不能出现下划线\'_\'';
                }
                if(value.length>24){
                    return '用户名长度不能超过24位';
                }
               /* if(/^\d+\d+\d$/.test(value)){
                    return '用户名不能全为数字';
                }*/
            }
            //我们既支持上述函数式的方式，也支持下述数组的形式
            //数组的两个值分别代表：[正则匹配、匹配不符时的提示文字]
            ,pass: [
                /^[\S]{0,15}$/
                ,'密码必须4到16位，且不能出现空格'
            ]
        });

        //监听提交
        form.on('submit(lianku)', function(data){
            $.ajax({
                type: "POST",
                async:false,
                dataType: "json",
                url: "/i/user/login",
                data:  data.field,
                beforeSend: function () {
                    data.elem.innerText='登录中';
                },
                success: function (data) {
                    if(data.success){
                        var token = data.message.substr(6);
                        $.ajax({
                            type: "GET",
                            url: "/i/user/findUser",
                            dataType: "json",
                            data: {token: token,isupdate: true},
                            success: function(data) {
                                if (data && data.id != 0) {
                                    window.lkuser=data;
                                    window.sessionStorage.lkuser=JSON.stringify(data);
                                    window.sessionStorage.longtime=new Date().getTime();
                                    if(localStorage.OURL){
                                        window.location.href=localStorage.OURL;
                                    }else{
                                        window.location.href='../../index.html';
                                    }
                                    localStorage.removeItem('OURL');
                                } else {
                                    window.sessionStorage.removeItem("lkuser");//清除系统user;
                                }
                            }
                        });
                    }else{
                        layer.alert(data.message, {icon:5});
                        return false;
                    }

                }
            });
        });
    });

</script>
</body>
</html>